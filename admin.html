<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Campeonato RoboRace</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f4f9f5 0%, #e8f5e8 100%);
      min-height: 100vh;
      color: #000;
      line-height: 1.6;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      background: linear-gradient(135deg, #348312 0%, #2a650e 100%);
      color: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(52, 131, 18, 0.3);
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
    }

    .header h1 {
      font-size: 2.2rem;
      margin-bottom: 8px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      position: relative;
      z-index: 1;
    }

    .header p {
      font-size: 1rem;
      opacity: 0.9;
      position: relative;
      z-index: 1;
    }

    .admin-nav {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .nav-btn {
      padding: 12px 24px;
      background: white;
      border: 2px solid #348312;
      border-radius: 25px;
      color: #348312;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .nav-btn:hover, .nav-btn.active {
      background: #348312;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(52, 131, 18, 0.3);
    }

    .admin-section {
      display: none;
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      border: 2px solid #348312;
    }

    .admin-section.active {
      display: block;
    }

    .section-title {
      color: #348312;
      font-size: 1.8rem;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      color: #348312;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .form-group input, .form-group select {
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-group input:focus, .form-group select:focus {
      outline: none;
      border-color: #348312;
      box-shadow: 0 0 10px rgba(52, 131, 18, 0.2);
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary {
      background: #348312;
      color: white;
    }

    .btn-primary:hover {
      background: #2a650e;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(52, 131, 18, 0.3);
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
      transform: translateY(-2px);
    }

    .btn-danger {
      background: #dc3545;
      color: white;
    }

    .btn-danger:hover {
      background: #c82333;
      transform: translateY(-2px);
    }

    .btn-success {
      background: #28a745;
      color: white;
    }

    .btn-success:hover {
      background: #218838;
      transform: translateY(-2px);
    }

    .table-container {
      overflow-x: auto;
      margin-top: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    th, td {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
    }

    th {
      background: linear-gradient(135deg, #348312 0%, #2a650e 100%);
      color: white;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    tr:hover {
      background: linear-gradient(90deg, #eaf6ea 0%, #f0f8f0 100%);
    }

    .action-buttons {
      display: flex;
      gap: 8px;
      justify-content: center;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 0.875rem;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-left: 4px solid #348312;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .stat-number {
      font-size: 2rem;
      font-weight: bold;
      color: #348312;
      margin-bottom: 5px;
    }

    .stat-label {
      color: #666;
      font-size: 0.9rem;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }

    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 30px;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      position: relative;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      position: absolute;
      right: 20px;
      top: 15px;
    }

    .close:hover {
      color: #348312;
    }

    .alert {
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      border-left: 4px solid;
    }

    .alert-success {
      background-color: #d4edda;
      border-color: #28a745;
      color: #155724;
    }

    .alert-danger {
      background-color: #f8d7da;
      border-color: #dc3545;
      color: #721c24;
    }

    .alert-info {
      background-color: #d1ecf1;
      border-color: #17a2b8;
      color: #0c5460;
    }

    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      .header h1 {
        font-size: 1.8rem;
      }
      
      .admin-nav {
        flex-direction: column;
        align-items: center;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .action-buttons {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üîß Painel Administrativo</h1>
      <p>Gerenciamento do Campeonato RoboRace</p>
    </div>

    <div class="admin-nav">
      <button class="nav-btn active" onclick="showSection('dashboard')">üìä Dashboard</button>
      <button class="nav-btn" onclick="showSection('schools')">üè´ Escolas</button>
      <button class="nav-btn" onclick="showSection('points')">üéØ Pontua√ß√µes</button>
      <button class="nav-btn" onclick="showSection('competitions')">üèÜ Competi√ß√µes</button>
      <button class="nav-btn" onclick="showSection('reports')">üìà Relat√≥rios</button>
    </div>

    <!-- Dashboard Section -->
    <div id="dashboard" class="admin-section active">
      <h2 class="section-title">üìä Dashboard</h2>
      
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number" id="totalSchools">0</div>
          <div class="stat-label">Escolas Cadastradas</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="totalPoints">0</div>
          <div class="stat-label">Total de Pontos</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="totalCompetitions">0</div>
          <div class="stat-label">Competi√ß√µes</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="avgPoints">0</div>
          <div class="stat-label">M√©dia de Pontos</div>
        </div>
      </div>

      <div class="table-container">
        <h3 style="color: #348312; margin-bottom: 15px;">üèÜ Ranking Atual</h3>
        <table id="rankingTable">
          <thead>
            <tr>
              <th>Posi√ß√£o</th>
              <th>Escola</th>
              <th>Pontos</th>
              <th>Competi√ß√µes</th>
              <th>√öltima Atualiza√ß√£o</th>
            </tr>
          </thead>
          <tbody id="rankingBody">
          </tbody>
        </table>
      </div>
    </div>

    <!-- Schools Section -->
    <div id="schools" class="admin-section">
      <h2 class="section-title">üè´ Gerenciar Escolas</h2>
      
      <div class="form-grid">
        <div class="form-group">
          <label for="schoolName">Nome da Escola:</label>
          <input type="text" id="schoolName" placeholder="Digite o nome da escola">
        </div>
        <div class="form-group">
          <label for="schoolCode">C√≥digo da Escola:</label>
          <input type="text" id="schoolCode" placeholder="Ex: ALFA001">
        </div>
        <div class="form-group">
          <label for="schoolCity">Cidade:</label>
          <input type="text" id="schoolCity" placeholder="Digite a cidade">
        </div>
        <div class="form-group">
          <label for="schoolState">Estado:</label>
          <select id="schoolState">
            <option value="">Selecione o estado</option>
            <option value="SP">S√£o Paulo</option>
            <option value="RJ">Rio de Janeiro</option>
            <option value="MG">Minas Gerais</option>
            <option value="RS">Rio Grande do Sul</option>
            <option value="PR">Paran√°</option>
            <option value="SC">Santa Catarina</option>
            <option value="BA">Bahia</option>
            <option value="GO">Goi√°s</option>
            <option value="PE">Pernambuco</option>
            <option value="CE">Cear√°</option>
          </select>
        </div>
      </div>
      
      <button class="btn btn-primary" onclick="addSchool()">‚ûï Adicionar Escola</button>
      
      <div class="table-container" style="margin-top: 30px;">
        <h3 style="color: #348312; margin-bottom: 15px;">üìã Escolas Cadastradas</h3>
        <table id="schoolsTable">
          <thead>
            <tr>
              <th>C√≥digo</th>
              <th>Nome</th>
              <th>Cidade</th>
              <th>Estado</th>
              <th>Status</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="schoolsBody">
          </tbody>
        </table>
      </div>
    </div>

    <!-- Points Section -->
    <div id="points" class="admin-section">
      <h2 class="section-title">üéØ Gerenciar Pontua√ß√µes</h2>
      
      <div class="form-grid">
        <div class="form-group">
          <label for="pointsSchool">Escola:</label>
          <select id="pointsSchool">
            <option value="">Selecione uma escola</option>
          </select>
        </div>
        <div class="form-group">
          <label for="pointsCompetition">Competi√ß√£o:</label>
          <select id="pointsCompetition">
            <option value="">Selecione uma competi√ß√£o</option>
          </select>
        </div>
        <div class="form-group">
          <label for="pointsValue">Pontos:</label>
          <input type="number" id="pointsValue" placeholder="Digite os pontos" min="0" max="100">
        </div>
        <div class="form-group">
          <label for="pointsDate">Data:</label>
          <input type="date" id="pointsDate">
        </div>
      </div>
      
      <button class="btn btn-primary" onclick="addPoints()">‚ûï Adicionar Pontos</button>
      
      <div class="table-container" style="margin-top: 30px;">
        <h3 style="color: #348312; margin-bottom: 15px;">üìä Hist√≥rico de Pontua√ß√µes</h3>
        <table id="pointsTable">
          <thead>
            <tr>
              <th>Data</th>
              <th>Escola</th>
              <th>Competi√ß√£o</th>
              <th>Pontos</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="pointsBody">
          </tbody>
        </table>
      </div>
    </div>

    <!-- Competitions Section -->
    <div id="competitions" class="admin-section">
      <h2 class="section-title">üèÜ Gerenciar Competi√ß√µes</h2>
      
      <div class="form-grid">
        <div class="form-group">
          <label for="competitionName">Nome da Competi√ß√£o:</label>
          <input type="text" id="competitionName" placeholder="Digite o nome da competi√ß√£o">
        </div>
        <div class="form-group">
          <label for="competitionDate">Data:</label>
          <input type="date" id="competitionDate">
        </div>
        <div class="form-group">
          <label for="competitionType">Tipo:</label>
          <select id="competitionType">
            <option value="">Selecione o tipo</option>
            <option value="eliminatoria">Eliminat√≥ria</option>
            <option value="pontuacao">Pontua√ß√£o</option>
            <option value="final">Final</option>
          </select>
        </div>
        <div class="form-group">
          <label for="competitionMaxPoints">Pontos M√°ximos:</label>
          <input type="number" id="competitionMaxPoints" placeholder="Ex: 100" min="1" max="1000">
        </div>
      </div>
      
      <button class="btn btn-primary" onclick="addCompetition()">‚ûï Adicionar Competi√ß√£o</button>
      
      <div class="table-container" style="margin-top: 30px;">
        <h3 style="color: #348312; margin-bottom: 15px;">üèÜ Competi√ß√µes Cadastradas</h3>
        <table id="competitionsTable">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Data</th>
              <th>Tipo</th>
              <th>Pontos M√°x.</th>
              <th>Status</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="competitionsBody">
          </tbody>
        </table>
      </div>
    </div>

    <!-- Reports Section -->
    <div id="reports" class="admin-section">
      <h2 class="section-title">üìà Relat√≥rios</h2>
      
      <div class="form-grid">
        <div class="form-group">
          <label for="reportType">Tipo de Relat√≥rio:</label>
          <select id="reportType" onchange="updateReportOptions()">
            <option value="">Selecione o tipo</option>
            <option value="ranking">Ranking Geral</option>
            <option value="school">Por Escola</option>
            <option value="competition">Por Competi√ß√£o</option>
            <option value="period">Por Per√≠odo</option>
          </select>
        </div>
        <div class="form-group" id="schoolFilter" style="display: none;">
          <label for="reportSchool">Escola:</label>
          <select id="reportSchool">
            <option value="">Todas as escolas</option>
          </select>
        </div>
        <div class="form-group" id="dateFilter" style="display: none;">
          <label for="reportDateFrom">Data Inicial:</label>
          <input type="date" id="reportDateFrom">
        </div>
        <div class="form-group" id="dateFilterTo" style="display: none;">
          <label for="reportDateTo">Data Final:</label>
          <input type="date" id="reportDateTo">
        </div>
      </div>
      
      <button class="btn btn-primary" onclick="generateReport()">üìä Gerar Relat√≥rio</button>
      <button class="btn btn-secondary" onclick="exportReport()">üì• Exportar</button>
      
      <div id="reportResults" style="margin-top: 30px;"></div>
    </div>
  </div>

  <!-- Modal for editing -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2 id="modalTitle">Editar</h2>
      <div id="modalContent"></div>
    </div>
  </div>

  <script>
    // Dados do sistema
    let schools = JSON.parse(localStorage.getItem('roborace_schools')) || [
      { id: 1, code: 'ALFA001', name: 'Escola Alfa', city: 'S√£o Paulo', state: 'SP', status: 'ativo' },
      { id: 2, code: 'BETA002', name: 'Col√©gio Beta', city: 'Rio de Janeiro', state: 'RJ', status: 'ativo' },
      { id: 3, code: 'GAMA003', name: 'Instituto Gama', city: 'Belo Horizonte', state: 'MG', status: 'ativo' },
      { id: 4, code: 'DELTA004', name: 'Escola Delta', city: 'Porto Alegre', state: 'RS', status: 'ativo' },
      { id: 5, code: 'OMEGA005', name: 'Col√©gio √îmega', city: 'Curitiba', state: 'PR', status: 'ativo' }
    ];

    let competitions = JSON.parse(localStorage.getItem('roborace_competitions')) || [
      { id: 1, name: 'Desafio de Programa√ß√£o', date: '2024-01-15', type: 'pontuacao', maxPoints: 100, status: 'concluida' },
      { id: 2, name: 'Corrida de Obst√°culos', date: '2024-01-22', type: 'eliminatoria', maxPoints: 80, status: 'concluida' },
      { id: 3, name: 'Batalha de Rob√¥s', date: '2024-01-29', type: 'final', maxPoints: 120, status: 'ativa' }
    ];

    let points = JSON.parse(localStorage.getItem('roborace_points')) || [
      { id: 1, schoolId: 1, competitionId: 1, points: 95, date: '2024-01-15' },
      { id: 2, schoolId: 2, competitionId: 1, points: 88, date: '2024-01-15' },
      { id: 3, schoolId: 3, competitionId: 1, points: 92, date: '2024-01-15' },
      { id: 4, schoolId: 1, competitionId: 2, points: 75, date: '2024-01-22' },
      { id: 5, schoolId: 2, competitionId: 2, points: 80, date: '2024-01-22' },
      { id: 6, schoolId: 3, competitionId: 2, points: 70, date: '2024-01-22' }
    ];

    // Fun√ß√£o para salvar dados
    function saveData() {
      localStorage.setItem('roborace_schools', JSON.stringify(schools));
      localStorage.setItem('roborace_competitions', JSON.stringify(competitions));
      localStorage.setItem('roborace_points', JSON.stringify(points));
      updateDashboard();
    }

    // Fun√ß√£o para mostrar se√ß√£o
    function showSection(sectionId) {
      // Esconder todas as se√ß√µes
      document.querySelectorAll('.admin-section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Remover classe active de todos os bot√µes
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Mostrar se√ß√£o selecionada
      document.getElementById(sectionId).classList.add('active');
      
      // Adicionar classe active ao bot√£o clicado
      event.target.classList.add('active');
      
      // Atualizar dados espec√≠ficos da se√ß√£o
      if (sectionId === 'schools') {
        loadSchools();
      } else if (sectionId === 'points') {
        loadPoints();
        updateSchoolSelects();
      } else if (sectionId === 'competitions') {
        loadCompetitions();
      } else if (sectionId === 'reports') {
        updateReportOptions();
      }
    }

    // Fun√ß√£o para atualizar dashboard
    function updateDashboard() {
      const totalSchools = schools.filter(s => s.status === 'ativo').length;
      const totalPoints = points.reduce((sum, p) => sum + p.points, 0);
      const totalCompetitions = competitions.length;
      const avgPoints = totalSchools > 0 ? Math.round(totalPoints / totalSchools) : 0;

      document.getElementById('totalSchools').textContent = totalSchools;
      document.getElementById('totalPoints').textContent = totalPoints;
      document.getElementById('totalCompetitions').textContent = totalCompetitions;
      document.getElementById('avgPoints').textContent = avgPoints;

      // Atualizar ranking
      updateRanking();
    }

    // Fun√ß√£o para atualizar ranking
    function updateRanking() {
      const schoolPoints = {};
      
      // Calcular pontos por escola
      points.forEach(point => {
        if (!schoolPoints[point.schoolId]) {
          schoolPoints[point.schoolId] = { total: 0, competitions: 0 };
        }
        schoolPoints[point.schoolId].total += point.points;
        schoolPoints[point.schoolId].competitions++;
      });

      // Criar array de escolas com pontos
      const ranking = schools
        .filter(school => school.status === 'ativo')
        .map(school => ({
          ...school,
          totalPoints: schoolPoints[school.id]?.total || 0,
          competitions: schoolPoints[school.id]?.competitions || 0
        }))
        .sort((a, b) => b.totalPoints - a.totalPoints);

      // Atualizar tabela
      const tbody = document.getElementById('rankingBody');
      tbody.innerHTML = '';

      ranking.forEach((school, index) => {
        const row = tbody.insertRow();
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${school.name}</td>
          <td><strong>${school.totalPoints}</strong></td>
          <td>${school.competitions}</td>
          <td>${new Date().toLocaleDateString('pt-BR')}</td>
        `;
      });
    }

    // Fun√ß√£o para carregar escolas
    function loadSchools() {
      const tbody = document.getElementById('schoolsBody');
      tbody.innerHTML = '';

      schools.forEach(school => {
        const row = tbody.insertRow();
        row.innerHTML = `
          <td>${school.code}</td>
          <td>${school.name}</td>
          <td>${school.city}</td>
          <td>${school.state}</td>
          <td><span class="badge ${school.status === 'ativo' ? 'badge-success' : 'badge-danger'}">${school.status}</span></td>
          <td class="action-buttons">
            <button class="btn btn-sm btn-primary" onclick="editSchool(${school.id})">‚úèÔ∏è</button>
            <button class="btn btn-sm btn-danger" onclick="deleteSchool(${school.id})">üóëÔ∏è</button>
          </td>
        `;
      });
    }

    // Fun√ß√£o para adicionar escola
    function addSchool() {
      const name = document.getElementById('schoolName').value;
      const code = document.getElementById('schoolCode').value;
      const city = document.getElementById('schoolCity').value;
      const state = document.getElementById('schoolState').value;

      if (!name || !code || !city || !state) {
        showAlert('Por favor, preencha todos os campos!', 'danger');
        return;
      }

      const newSchool = {
        id: Date.now(),
        code: code.toUpperCase(),
        name,
        city,
        state,
        status: 'ativo'
      };

      schools.push(newSchool);
      saveData();
      loadSchools();
      clearSchoolForm();
      showAlert('Escola adicionada com sucesso!', 'success');
    }

    // Fun√ß√£o para limpar formul√°rio de escola
    function clearSchoolForm() {
      document.getElementById('schoolName').value = '';
      document.getElementById('schoolCode').value = '';
      document.getElementById('schoolCity').value = '';
      document.getElementById('schoolState').value = '';
    }

    // Fun√ß√£o para atualizar selects de escola
    function updateSchoolSelects() {
      const selects = ['pointsSchool', 'reportSchool'];
      
      selects.forEach(selectId => {
        const select = document.getElementById(selectId);
        const currentValue = select.value;
        
        select.innerHTML = selectId === 'reportSchool' ? '<option value="">Todas as escolas</option>' : '<option value="">Selecione uma escola</option>';
        
        schools.filter(s => s.status === 'ativo').forEach(school => {
          const option = document.createElement('option');
          option.value = school.id;
          option.textContent = school.name;
          select.appendChild(option);
        });
        
        select.value = currentValue;
      });
    }

    // Fun√ß√£o para carregar competi√ß√µes
    function loadCompetitions() {
      const tbody = document.getElementById('competitionsBody');
      tbody.innerHTML = '';

      competitions.forEach(competition => {
        const row = tbody.insertRow();
        row.innerHTML = `
          <td>${competition.name}</td>
          <td>${new Date(competition.date).toLocaleDateString('pt-BR')}</td>
          <td>${competition.type}</td>
          <td>${competition.maxPoints}</td>
          <td><span class="badge ${competition.status === 'ativa' ? 'badge-success' : 'badge-secondary'}">${competition.status}</span></td>
          <td class="action-buttons">
            <button class="btn btn-sm btn-primary" onclick="editCompetition(${competition.id})">‚úèÔ∏è</button>
            <button class="btn btn-sm btn-danger" onclick="deleteCompetition(${competition.id})">üóëÔ∏è</button>
          </td>
        `;
      });
    }

    // Fun√ß√£o para adicionar competi√ß√£o
    function addCompetition() {
      const name = document.getElementById('competitionName').value;
      const date = document.getElementById('competitionDate').value;
      const type = document.getElementById('competitionType').value;
      const maxPoints = document.getElementById('competitionMaxPoints').value;

      if (!name || !date || !type || !maxPoints) {
        showAlert('Por favor, preencha todos os campos!', 'danger');
        return;
      }

      const newCompetition = {
        id: Date.now(),
        name,
        date,
        type,
        maxPoints: parseInt(maxPoints),
        status: 'ativa'
      };

      competitions.push(newCompetition);
      saveData();
      loadCompetitions();
      clearCompetitionForm();
      updateCompetitionSelects();
      showAlert('Competi√ß√£o adicionada com sucesso!', 'success');
    }

    // Fun√ß√£o para limpar formul√°rio de competi√ß√£o
    function clearCompetitionForm() {
      document.getElementById('competitionName').value = '';
      document.getElementById('competitionDate').value = '';
      document.getElementById('competitionType').value = '';
      document.getElementById('competitionMaxPoints').value = '';
    }

    // Fun√ß√£o para atualizar selects de competi√ß√£o
    function updateCompetitionSelects() {
      const select = document.getElementById('pointsCompetition');
      const currentValue = select.value;
      
      select.innerHTML = '<option value="">Selecione uma competi√ß√£o</option>';
      
      competitions.filter(c => c.status === 'ativa').forEach(competition => {
        const option = document.createElement('option');
        option.value = competition.id;
        option.textContent = competition.name;
        select.appendChild(option);
      });
      
      select.value = currentValue;
    }

    // Fun√ß√£o para carregar pontos
    function loadPoints() {
      const tbody = document.getElementById('pointsBody');
      tbody.innerHTML = '';

      points.forEach(point => {
        const school = schools.find(s => s.id === point.schoolId);
        const competition = competitions.find(c => c.id === point.competitionId);
        
        const row = tbody.insertRow();
        row.innerHTML = `
          <td>${new Date(point.date).toLocaleDateString('pt-BR')}</td>
          <td>${school ? school.name : 'Escola n√£o encontrada'}</td>
          <td>${competition ? competition.name : 'Competi√ß√£o n√£o encontrada'}</td>
          <td><strong>${point.points}</strong></td>
          <td class="action-buttons">
            <button class="btn btn-sm btn-primary" onclick="editPoint(${point.id})">‚úèÔ∏è</button>
            <button class="btn btn-sm btn-danger" onclick="deletePoint(${point.id})">üóëÔ∏è</button>
          </td>
        `;
      });
    }

    // Fun√ß√£o para adicionar pontos
    function addPoints() {
      const schoolId = parseInt(document.getElementById('pointsSchool').value);
      const competitionId = parseInt(document.getElementById('pointsCompetition').value);
      const pointsValue = parseInt(document.getElementById('pointsValue').value);
      const date = document.getElementById('pointsDate').value;

      if (!schoolId || !competitionId || !pointsValue || !date) {
        showAlert('Por favor, preencha todos os campos!', 'danger');
        return;
      }

      const competition = competitions.find(c => c.id === competitionId);
      if (pointsValue > competition.maxPoints) {
        showAlert(`Pontos n√£o podem exceder ${competition.maxPoints}!`, 'danger');
        return;
      }

      const newPoint = {
        id: Date.now(),
        schoolId,
        competitionId,
        points: pointsValue,
        date
      };

      points.push(newPoint);
      saveData();
      loadPoints();
      clearPointsForm();
      showAlert('Pontos adicionados com sucesso!', 'success');
    }

    // Fun√ß√£o para limpar formul√°rio de pontos
    function clearPointsForm() {
      document.getElementById('pointsSchool').value = '';
      document.getElementById('pointsCompetition').value = '';
      document.getElementById('pointsValue').value = '';
      document.getElementById('pointsDate').value = '';
    }

    // Fun√ß√£o para mostrar alerta
    function showAlert(message, type) {
      const alertDiv = document.createElement('div');
      alertDiv.className = `alert alert-${type}`;
      alertDiv.textContent = message;
      
      const container = document.querySelector('.container');
      container.insertBefore(alertDiv, container.firstChild);
      
      setTimeout(() => {
        alertDiv.remove();
      }, 3000);
    }

    // Fun√ß√£o para fechar modal
    function closeModal() {
      document.getElementById('editModal').style.display = 'none';
    }

    // Fun√ß√£o para atualizar op√ß√µes de relat√≥rio
    function updateReportOptions() {
      const reportType = document.getElementById('reportType').value;
      const schoolFilter = document.getElementById('schoolFilter');
      const dateFilter = document.getElementById('dateFilter');
      const dateFilterTo = document.getElementById('dateFilterTo');

      // Esconder todos os filtros
      schoolFilter.style.display = 'none';
      dateFilter.style.display = 'none';
      dateFilterTo.style.display = 'none';

      // Mostrar filtros baseado no tipo
      if (reportType === 'school') {
        schoolFilter.style.display = 'block';
        updateSchoolSelects();
      } else if (reportType === 'period') {
        dateFilter.style.display = 'block';
        dateFilterTo.style.display = 'block';
      }
    }

    // Fun√ß√£o para gerar relat√≥rio
    function generateReport() {
      const reportType = document.getElementById('reportType').value;
      const resultsDiv = document.getElementById('reportResults');
      
      if (!reportType) {
        showAlert('Selecione um tipo de relat√≥rio!', 'danger');
        return;
      }

      let reportData = '';
      
      switch(reportType) {
        case 'ranking':
          reportData = generateRankingReport();
          break;
        case 'school':
          const schoolId = document.getElementById('reportSchool').value;
          reportData = generateSchoolReport(schoolId);
          break;
        case 'competition':
          reportData = generateCompetitionReport();
          break;
        case 'period':
          const dateFrom = document.getElementById('reportDateFrom').value;
          const dateTo = document.getElementById('reportDateTo').value;
          reportData = generatePeriodReport(dateFrom, dateTo);
          break;
      }

      resultsDiv.innerHTML = reportData;
    }

    // Fun√ß√£o para gerar relat√≥rio de ranking
    function generateRankingReport() {
      const schoolPoints = {};
      
      points.forEach(point => {
        if (!schoolPoints[point.schoolId]) {
          schoolPoints[point.schoolId] = { total: 0, competitions: 0 };
        }
        schoolPoints[point.schoolId].total += point.points;
        schoolPoints[point.schoolId].competitions++;
      });

      const ranking = schools
        .filter(school => school.status === 'ativo')
        .map(school => ({
          ...school,
          totalPoints: schoolPoints[school.id]?.total || 0,
          competitions: schoolPoints[school.id]?.competitions || 0
        }))
        .sort((a, b) => b.totalPoints - a.totalPoints);

      let html = '<h3>üèÜ Ranking Geral</h3><table class="table"><thead><tr><th>Posi√ß√£o</th><th>Escola</th><th>Pontos</th><th>Competi√ß√µes</th></tr></thead><tbody>';
      
      ranking.forEach((school, index) => {
        html += `<tr><td>${index + 1}</td><td>${school.name}</td><td><strong>${school.totalPoints}</strong></td><td>${school.competitions}</td></tr>`;
      });
      
      html += '</tbody></table>';
      return html;
    }

    // Fun√ß√£o para exportar relat√≥rio
    function exportReport() {
      const reportType = document.getElementById('reportType').value;
      if (!reportType) {
        showAlert('Gere um relat√≥rio primeiro!', 'danger');
        return;
      }

      // Simular exporta√ß√£o
      showAlert('Relat√≥rio exportado com sucesso!', 'success');
    }

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', function() {
      updateDashboard();
      updateSchoolSelects();
      updateCompetitionSelects();
      
      // Definir data atual como padr√£o
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('pointsDate').value = today;
      document.getElementById('competitionDate').value = today;
    });
  </script>
</body>
</html>
